---
title: "Advanced `git`"
subtitle: "Best practices and debugging"
author: "JC"
institute: "SFG"
date: "2019/08/21 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

# Outline

If you haven't, `fork` and `clone` the repo from: [https://github.com/emlab-ucsb/adv_git.git](https://github.com/emlab-ucsb/adv_git.git)

- Boring

  - Best practices
  
- Hands-on

  - Repo tour
  
  - Tests

      - `shiny` Apps
  
      - functions / packages
  
  - Finding the error

  - Fixing the error


---

class: center, middle, inverse

# Best practices

---

# Use the terminal


- It doesn't have to be scary

- You'll mostly use `pull`, `add`, `commit`, and `push`

- It forces you to think about what you have to `stage` and `commit`

- It's good to get comfortable, especially when you have to fix a repo


---

# Commit frequency

- Try to keep commits as small as possible

  - Don't just `stage` all and `commit` "updated repo" (we all do it)
  
  - If possible, break it down to files / topics / improvements
  
  - If possible, break it down to sections within a file

- You don't have to `push` all your changes

  - `commit` through the day, and `push` at the end


---

# Testing your code

Create tests for possible breaks:

- Test for data integrity

  - Number of records
  
  - Dimensions of a key `data.frame`
  
  - Dates in your `Raster*` objects
    
- Test for function behavior

  - Returns correct output
  
  - Handles `NA`s or `NULL`s correctly
  
  - Test for know breaks
  
--

**Test before pushing big changes**

---

# Using tags

If something (ever) works, mark it!

- After your `commit`, you can do:

- `git tag -a version -m "message"`



---

# Using tags

In the repo, try:

```
git tag
```

You should get:

```
v0.1
v0.2

```

Not very informative, right?

---

# Using tags

Now try

```
git logline

```

or

```
git logone
```
---

class: center, middle, inverse

# Repo tour

---

# Repo

```
-- adv.Rproj
-- basic_app
   |__app.R
   |__tests
-- DESCRIPTION
-- man
   |__gal2lit.Rd
-- NAMESPACE
-- R
   |__gal2lit.R
-- README.md
-- tests
   |__testthat
   |__testthat.R
```
